;//////////////////////////////////////////////////////////////////////
;/// This file is subject to the terms and conditions defined in    ///
;/// file 'LICENSE.txt', which is part of this source code package. ///
;//////////////////////////////////////////////////////////////////////
[SEGMENT .text]

    ;////////////////////////////////////////////////////
    ;/// Define all modules includes
    ;////////////////////////////////////////////////////
    %include 'src/module/ModuleSpeedhack.asm'

    ;////////////////////////////////////////////////////
    ;/// Define foundation
    ;////////////////////////////////////////////////////
    %ifdef FND_MUNDOS_PERDIDOS
        %include 'src/foundation/MundosPerdidosAO/Foundation.asm'
        %include 'src/foundation/MundosPerdidosAO/FoundationValues.asm'
    %elif defined(FND_HISPANO)
        %include 'src/foundation/HispanoAO/Foundation.asm'
        %include 'src/foundation/HispanoAO/FoundationValues.asm'
    %endif
    
;////////////////////////////////////////////////////
;/// \brief Initialize foundation enviroment
;////////////////////////////////////////////////////
InitializeModule:
    PUSH EBP
    MOV  EBP, ESP
    
    ;////////////////////////////////////////////////
    ;/// Initialize SpeedHACK module
    ;////////////////////////////////////////////////
    CALL InitializeSpeedhackModule

    ;////////////////////////////////////////////////
    ;/// Initialize Foundation module
    ;////////////////////////////////////////////////
    CALL InitializeFoundation

    MOV  ESP, EBP
    POP  EBP
    RET

;////////////////////////////////////////////////////
;/// \brief Send data to the server
;///
;/// \param sndData The data to send to the server
;////////////////////////////////////////////////////
HandleOutgoingData:
    PUSH EBP
    MOV  EBP, ESP

    ;////////////////////////////////////////////////
    ;/// Debug the outgoing packet
    ;////////////////////////////////////////////////
    PUSH DWORD [EBP + 0x08]
    CALL DWORD [OutputDebugStringA]

    MOV  ESP, EBP
    POP  EBP
    RET  0x04

;////////////////////////////////////////////////////
;/// \brief Handle data from the server
;///
;/// \param data The data recived from the server
;////////////////////////////////////////////////////
HandleIncommingData:
    PUSH EBP
    MOV  EBP, ESP

    ;////////////////////////////////////////////////
    ;/// Debug the incomming packet
    ;////////////////////////////////////////////////
    PUSH DWORD [EBP + 0x08]
    CALL DWORD [OutputDebugStringA]
    
    MOV  ESP, EBP
    POP  EBP
    RET  0x04
